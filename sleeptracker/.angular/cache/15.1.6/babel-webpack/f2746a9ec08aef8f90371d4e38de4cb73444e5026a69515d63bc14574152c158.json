{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { OvernightSleepData } from '../data/overnight-sleep-data';\nimport { StanfordSleepinessData } from '../data/stanford-sleepiness-data';\nimport { Preferences } from '@capacitor/preferences';\nimport * as i0 from \"@angular/core\";\nexport class SleepService {\n  constructor() {\n    // if (SleepService.LoadDefaultData) {\n    // \tthis.addDefaultData();\n    // \tSleepService.LoadDefaultData = false;\n    // }\n    // this.loadOvernightData()\n    // \t.then((data) => {\n    // \t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n    // \t\t\tconsole.log(item);\n    // \t\t\tthis.logOvernightData(OvernightSleepData.fromJson(item))\n    // \t\t});\n    // \t\t// SleepService.AllOvernightData.push(...JSON.parse(data.value || '[]'));\n    // \t})\n    // .then(\n    // \t);\n    // Promise<GetResult> load2 = this.loadSleepinessData()\n    // \t.then((data) => {\n    // \t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n    // \t\t\tconsole.log(item);\n    // \t\t\tthis.logSleepinessData(StanfordSleepinessData.fromJson(item));\n    // \t\t});\n    // \t\treturn data;\n    // \t\t// SleepService.AllSleepinessData.push(...JSON.parse(data.value || '[]'));\n    // \t})\n    this.loadData().then(() => {\n      if (SleepService.AllSleepData.length == 0 && SleepService.LoadDefaultData) {\n        this.addDefaultData();\n        SleepService.LoadDefaultData = false;\n      }\n    });\n  }\n  loadData() {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield Preferences.get({\n        key: 'overnightData'\n      }).then(data => {\n        JSON.parse(data.value || '[]').forEach(item => {\n          console.log(item);\n          this.logOvernightData(OvernightSleepData.fromJson(item));\n        });\n        // SleepService.AllOvernightData.push(...JSON.parse(data.value || '[]'));\n      });\n\n      yield Preferences.get({\n        key: 'sleepinessData'\n      }).then(data => {\n        JSON.parse(data.value || '[]').forEach(item => {\n          console.log(item);\n          this.logSleepinessData(StanfordSleepinessData.fromJson(item));\n        });\n        return data;\n        // SleepService.AllSleepinessData.push(...JSON.parse(data.value || '[]'));\n      });\n    });\n  }\n\n  loadOvernightData() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return yield Preferences.get({\n        key: 'overnightData'\n      });\n    });\n  }\n  loadSleepinessData() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return yield Preferences.get({\n        key: 'sleepinessData'\n      });\n    });\n  }\n  addDefaultData() {\n    this.logOvernightData(new OvernightSleepData(new Date('February 18, 2021 01:03:00'), new Date('February 18, 2021 09:25:00')));\n    this.logSleepinessData(new StanfordSleepinessData(4, new Date('February 19, 2021 14:38:00')));\n    this.logOvernightData(new OvernightSleepData(new Date('February 20, 2021 23:11:00'), new Date('February 21, 2021 08:03:00')));\n  }\n  logOvernightData(sleepData) {\n    SleepService.AllSleepData.push(sleepData);\n    SleepService.AllOvernightData.push(sleepData);\n    this.saveOvernightData();\n  }\n  logSleepinessData(sleepData) {\n    SleepService.AllSleepData.push(sleepData);\n    SleepService.AllSleepinessData.push(sleepData);\n    this.saveSleepinessData();\n  }\n  saveOvernightData() {\n    Preferences.set({\n      key: 'overnightData',\n      value: JSON.stringify(SleepService.AllOvernightData)\n    });\n  }\n  saveSleepinessData() {\n    Preferences.set({\n      key: 'sleepinessData',\n      value: JSON.stringify(SleepService.AllSleepinessData)\n    });\n  }\n  clearData() {\n    Preferences.set({\n      key: 'overnightData',\n      value: JSON.stringify([])\n    });\n    Preferences.set({\n      key: 'sleepinessData',\n      value: JSON.stringify([])\n    });\n    SleepService.AllSleepData = [];\n    SleepService.AllOvernightData = [];\n    SleepService.AllSleepinessData = [];\n  }\n}\nSleepService.LoadDefaultData = true;\nSleepService.AllSleepData = [];\nSleepService.AllOvernightData = [];\nSleepService.AllSleepinessData = [];\nSleepService.ɵfac = function SleepService_Factory(t) {\n  return new (t || SleepService)();\n};\nSleepService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: SleepService,\n  factory: SleepService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["OvernightSleepData","StanfordSleepinessData","Preferences","SleepService","constructor","loadData","then","AllSleepData","length","LoadDefaultData","addDefaultData","get","key","data","JSON","parse","value","forEach","item","console","log","logOvernightData","fromJson","logSleepinessData","loadOvernightData","loadSleepinessData","Date","sleepData","push","AllOvernightData","saveOvernightData","AllSleepinessData","saveSleepinessData","set","stringify","clearData","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\philt\\inf133\\sleep-tracker\\sleeptracker\\src\\app\\services\\sleep.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { SleepData } from '../data/sleep-data';\nimport { OvernightSleepData } from '../data/overnight-sleep-data';\nimport { StanfordSleepinessData } from '../data/stanford-sleepiness-data';\nimport { Preferences } from '@capacitor/preferences';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SleepService {\n\tprivate static LoadDefaultData: boolean = true;\n\tpublic static AllSleepData: SleepData[] = [];\n\tpublic static AllOvernightData: OvernightSleepData[] = [];\n\tpublic static AllSleepinessData: StanfordSleepinessData[] = [];\n\n\tconstructor() {\n\t\t// if (SleepService.LoadDefaultData) {\n\t\t// \tthis.addDefaultData();\n\t\t// \tSleepService.LoadDefaultData = false;\n\t\t// }\n\n\t\t// this.loadOvernightData()\n\t\t// \t.then((data) => {\n\t\t// \t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n\t\t// \t\t\tconsole.log(item);\n\t\t// \t\t\tthis.logOvernightData(OvernightSleepData.fromJson(item))\n\t\t// \t\t});\n\t\t// \t\t// SleepService.AllOvernightData.push(...JSON.parse(data.value || '[]'));\n\t\t// \t})\n\t\t// .then(\n\n\t\t// \t);\n\t\t// Promise<GetResult> load2 = this.loadSleepinessData()\n\t\t// \t.then((data) => {\n\t\t// \t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n\t\t// \t\t\tconsole.log(item);\n\t\t// \t\t\tthis.logSleepinessData(StanfordSleepinessData.fromJson(item));\n\t\t// \t\t});\n\t\t// \t\treturn data;\n\t\t// \t\t// SleepService.AllSleepinessData.push(...JSON.parse(data.value || '[]'));\n\t\t// \t})\n\t\t\n\t\tthis.loadData()\n\t\t\t.then(() => {\n\t\t\t\tif (SleepService.AllSleepData.length == 0 && SleepService.LoadDefaultData) {\n\t\t\t\t\tthis.addDefaultData();\n\t\t\t\t\tSleepService.LoadDefaultData = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t)\n\n\t}\n\n\tprivate async loadData() {\n\t\tawait Preferences.get({ key: 'overnightData' })\n\t\t.then((data) => {\n\t\t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n\t\t\t\tconsole.log(item);\n\t\t\t\tthis.logOvernightData(OvernightSleepData.fromJson(item))\n\t\t\t});\n\t\t\t// SleepService.AllOvernightData.push(...JSON.parse(data.value || '[]'));\n\t\t});\n\n\t\tawait Preferences.get({ key: 'sleepinessData' })\n\t\t.then((data) => {\n\t\t\tJSON.parse(data.value || '[]').forEach((item: {}) => {\n\t\t\t\tconsole.log(item);\n\t\t\t\tthis.logSleepinessData(StanfordSleepinessData.fromJson(item));\n\t\t\t});\n\t\t\treturn data;\n\t\t\t// SleepService.AllSleepinessData.push(...JSON.parse(data.value || '[]'));\n\t\t});\n\t}\n\n\tprivate async loadOvernightData() {\n\t\treturn await Preferences.get({ key: 'overnightData' });\n\t}\n\tprivate async loadSleepinessData() {\n\t\treturn await Preferences.get({ key: 'sleepinessData' });\n\t}\n\n\n\tprivate addDefaultData() {\n\t\tthis.logOvernightData(new OvernightSleepData(new Date('February 18, 2021 01:03:00'), new Date('February 18, 2021 09:25:00')));\n\t\tthis.logSleepinessData(new StanfordSleepinessData(4, new Date('February 19, 2021 14:38:00')));\n\t\tthis.logOvernightData(new OvernightSleepData(new Date('February 20, 2021 23:11:00'), new Date('February 21, 2021 08:03:00')));\n\t}\n\n\tpublic logOvernightData(sleepData: OvernightSleepData) {\n\t\tSleepService.AllSleepData.push(sleepData);\n\t\tSleepService.AllOvernightData.push(sleepData);\n\t\tthis.saveOvernightData();\n\t}\n\n\tpublic logSleepinessData(sleepData: StanfordSleepinessData) {\n\t\tSleepService.AllSleepData.push(sleepData);\n\t\tSleepService.AllSleepinessData.push(sleepData);\n\t\tthis.saveSleepinessData();\n\t}\n\n\tprivate saveOvernightData() {\n\t\tPreferences.set({ key: 'overnightData', value: JSON.stringify(SleepService.AllOvernightData) });\n\t}\n\n\tprivate saveSleepinessData() {\n\t\tPreferences.set({ key: 'sleepinessData', value: JSON.stringify(SleepService.AllSleepinessData) });\n\t}\n\n\tprivate clearData() {\n\t\tPreferences.set({ key: 'overnightData', value: JSON.stringify([]) });\n\t\tPreferences.set({ key: 'sleepinessData', value: JSON.stringify([]) });\t\t\n\t\tSleepService.AllSleepData = [];\n\t\tSleepService.AllOvernightData = [];\n\t\tSleepService.AllSleepinessData = [];\n\t}\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}